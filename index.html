<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#0d9488">
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self'; connect-src 'self'; img-src 'self' blob:; style-src 'self' 'unsafe-inline'">
  <meta name="description" content="Goja 拼图成格">
  <title>Goja</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="assets/logo-192.svg">
</head>
<body>
  <a href="#main-content" class="skip-link" data-i18n="skipToContent">Skip to main content</a>
  <header class="top-bar">
    <div class="top-bar__brand" data-i18n="brand">Goja</div>
    <p class="top-bar__tagline" data-i18n="tagline">Grid your photos.</p>
    <div class="top-bar__actions">
      <span class="top-bar__version" id="versionLabel" aria-hidden="true"></span>
      <button class="top-bar__settings" id="settingsBtn" data-i18n-aria-label="settings" aria-label="Settings">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
      </svg>
    </button>
    </div>
  </header>

  <main class="main-content" id="main-content">
    <div class="offline-banner" id="offlineBanner" aria-live="polite" hidden>
      <span data-i18n="offlineMessage">Offline — Goja works offline</span>
    </div>
    <div class="loading-overlay" id="loadingOverlay" aria-live="polite" aria-busy="true" hidden>
      <span id="loadingText">Loading...</span>
    </div>
    <div class="drop-zone" id="dropZone">
      <div class="drop-zone__icon">+</div>
      <div class="drop-zone__text" data-i18n="dropZoneText">Drop photos here or tap to select</div>
      <input type="file" id="fileInput" accept="image/*" multiple>
    </div>

    <section class="preview" id="preview">
      <div class="preview__grid" id="previewGrid"></div>
    </section>
  </main>

  <nav class="bottom-bar" id="bottomBar">
    <button class="btn btn-secondary" id="addBtn" data-i18n="addBtn">+ Add</button>
    <button class="btn btn-primary" id="exportBtn" disabled data-i18n="exportBtn">Export</button>
    <button class="btn btn-secondary" id="clearBtn" data-i18n="clearBtn">Clear</button>
  </nav>

  <div class="settings-backdrop" id="settingsBackdrop"></div>
  <aside class="settings-panel" id="settingsPanel" role="dialog" aria-labelledby="settingsTitle" aria-modal="true" aria-hidden="true">
    <div class="settings-panel__header">
      <div class="settings-panel__handle"></div>
      <h2 id="settingsTitle" data-i18n="settings">Settings</h2>
      <button class="settings-panel__close" id="settingsCloseBtn" data-i18n-aria-label="closeSettings" aria-label="Close settings">&times;</button>
    </div>
    <div class="settings-panel__body">
      <fieldset class="settings-section">
        <legend data-i18n="grid">Grid</legend>
        <div class="control-group">
          <label for="langSelect" data-i18n="language">Language</label>
          <select id="langSelect">
            <option value="en" data-i18n="langEn">English</option>
            <option value="zh-Hans" data-i18n="langZhHans">简体中文</option>
            <option value="zh-Hant" data-i18n="langZhHant">繁體中文</option>
            <option value="de" data-i18n="langDe">Deutsch</option>
            <option value="nl" data-i18n="langNl">Nederlands</option>
            <option value="es" data-i18n="langEs">Español</option>
            <option value="it" data-i18n="langIt">Italiano</option>
            <option value="tr" data-i18n="langTr">Türkçe</option>
            <option value="fi" data-i18n="langFi">Suomi</option>
            <option value="ja" data-i18n="langJa">日本語</option>
            <option value="eo" data-i18n="langEo">Esperanto</option>
          </select>
        </div>
        <div class="control-group">
          <label for="frameWidth" data-i18n="width">Width</label>
          <input type="number" id="frameWidth" value="1080" min="320" max="4096" step="1"
            inputmode="numeric" pattern="[0-9]*"
            aria-describedby="frameDimensionHint" aria-invalid="false">
        </div>
        <div class="control-group">
          <label for="frameHeight" data-i18n="height">Height</label>
          <input type="number" id="frameHeight" value="1350" min="320" max="4096" step="1"
            inputmode="numeric" pattern="[0-9]*"
            aria-describedby="frameDimensionHint" aria-invalid="false">
        </div>
        <p class="control-hint" id="frameDimensionHint" data-i18n="frameDimensionHint">320–4096 px</p>
        <div class="control-group">
          <span class="control-label" data-i18n="aspectPresets">Aspect presets</span>
          <div class="preset-buttons" id="aspectPresets">
            <button type="button" data-w="1080" data-h="1080" data-i18n="preset11">1:1</button>
            <button type="button" data-w="1080" data-h="1440" data-i18n="preset34">3:4</button>
            <button type="button" data-w="1080" data-h="608" data-i18n="preset169">16:9</button>
            <button type="button" data-w="1080" data-h="1350" data-i18n="presetInstagram">Instagram</button>
            <button type="button" data-w="1080" data-h="1920" data-i18n="presetStories">Stories</button>
            <button type="button" data-w="1080" data-h="1920" data-i18n="presetDouyin">抖音</button>
            <button type="button" data-w="1080" data-h="1440" data-i18n="presetXiaohongshu">小红书</button>
            <button type="button" data-w="1080" data-h="1920" data-i18n="presetKuaishou">快手</button>
            <button type="button" data-w="1080" data-h="1920" data-i18n="presetWechatChannels">视频号</button>
          </div>
        </div>
        <div class="control-group">
          <label for="gapSlider" data-i18n="gap">Gap</label>
          <input type="range" id="gapSlider" min="0" max="20" value="4" step="1">
        </div>
        <div class="control-group" id="templatePickerGroup">
          <label for="templateSelect" data-i18n="template">Template</label>
          <select id="templateSelect">
            <option value="auto" data-i18n="templateAuto">Auto</option>
          </select>
        </div>
        <div class="control-group">
          <label for="imageFit" data-i18n="imageFit">Image fit</label>
          <select id="imageFit">
            <option value="cover" data-i18n="fitCover">Fill</option>
            <option value="contain" data-i18n="fitContain">Full display</option>
          </select>
        </div>
      </fieldset>
      <fieldset class="settings-section">
        <legend data-i18n="exportSection">Export</legend>
        <div class="control-group">
          <label for="exportFilename" data-i18n="exportFilename">Filename</label>
          <input type="text" id="exportFilename" data-i18n-placeholder="exportFilenamePlaceholder" placeholder="goja-grid" maxlength="60">
        </div>
        <div class="control-group">
          <label>
            <input type="checkbox" id="exportUseDate">
            <span data-i18n="exportUseDate">Add date to filename</span>
          </label>
        </div>
        <div class="control-group">
          <label>
            <input type="checkbox" id="showCaptureDate">
            <span data-i18n="showCaptureDate">Show capture date on photos</span>
          </label>
        </div>
        <div id="captureDateOptionsGroup" class="hidden">
          <div class="control-group">
            <label for="captureDatePos" data-i18n="captureDatePos">Position</label>
            <select id="captureDatePos">
              <option value="bottom-left" data-i18n="posBottomLeft">Bottom-left</option>
              <option value="bottom-right" data-i18n="posBottomRight">Bottom-right</option>
              <option value="top-left" data-i18n="posTopLeft">Top-left</option>
              <option value="top-right" data-i18n="posTopRight">Top-right</option>
            </select>
          </div>
          <div class="control-group">
            <label for="captureDateOpacity" data-i18n="captureDateOpacity">Opacity</label>
            <input type="range" id="captureDateOpacity" min="0.3" max="0.9" step="0.1" value="0.7">
          </div>
          <div class="control-group">
            <label for="captureDateFontSize" data-i18n="captureDateFontSize">Font size</label>
            <select id="captureDateFontSize">
              <option value="0.8" data-i18n="fontSizeSmall">Small</option>
              <option value="1" data-i18n="fontSizeMedium" selected>Medium</option>
              <option value="1.2" data-i18n="fontSizeLarge">Large</option>
            </select>
          </div>
        </div>
        <div class="control-group">
          <label for="bgColor" data-i18n="background">Background</label>
          <input type="color" id="bgColor" value="#ffffff">
        </div>
        <div class="control-group">
          <label for="formatSelect" data-i18n="format">Format</label>
          <select id="formatSelect">
            <option value="image/jpeg">JPEG</option>
            <option value="image/png">PNG</option>
          </select>
        </div>
      </fieldset>
      <fieldset class="settings-section">
        <legend data-i18n="effectsSection">Effects</legend>
        <div class="control-group">
          <label for="filterPreset" data-i18n="filterPreset">Filter</label>
          <select id="filterPreset">
            <option value="none" data-i18n="filterNone">None</option>
            <option value="grayscale" data-i18n="filterGrayscale">Grayscale</option>
            <option value="sepia" data-i18n="filterSepia">Sepia</option>
            <option value="brightness" data-i18n="filterBrightness">Brightness</option>
            <option value="contrast" data-i18n="filterContrast">Contrast</option>
            <option value="saturated" data-i18n="filterSaturated">Saturated</option>
            <option value="faded" data-i18n="filterFaded">Faded</option>
            <option value="vintage" data-i18n="filterVintage">Vintage</option>
            <option value="blur" data-i18n="filterBlur">Blur</option>
          </select>
        </div>
        <div class="control-group">
          <label>
            <input type="checkbox" id="vignetteEnabled">
            <span data-i18n="vignetteEnabled">Vignette</span>
          </label>
        </div>
        <div id="vignetteOptionsGroup" class="hidden">
          <div class="control-group">
            <label for="vignetteStrength" data-i18n="vignetteStrength">Intensity</label>
            <input type="range" id="vignetteStrength" min="0.2" max="0.8" step="0.1" value="0.5">
          </div>
        </div>
      </fieldset>
      <fieldset class="settings-section">
        <legend data-i18n="watermark">Watermark</legend>
        <div class="control-group">
          <label for="watermarkType" data-i18n="watermarkType">Type</label>
          <select id="watermarkType">
            <option value="none" data-i18n="watermarkNone">None</option>
            <option value="text" data-i18n="watermarkText">Free text</option>
            <option value="datetime" data-i18n="watermarkDatetime">Date/time</option>
            <option value="copyright" data-i18n="watermarkCopyright">Copyright</option>
          </select>
        </div>
        <div class="control-group hidden" id="watermarkPosGroup">
          <label for="watermarkPos" data-i18n="watermarkPos">Position</label>
          <select id="watermarkPos">
            <option value="bottom-right" data-i18n="posBottomRight">Bottom-right</option>
            <option value="bottom-left" data-i18n="posBottomLeft">Bottom-left</option>
            <option value="top-left" data-i18n="posTopLeft">Top-left</option>
            <option value="top-right" data-i18n="posTopRight">Top-right</option>
            <option value="center" data-i18n="posCenter">Center</option>
            <option value="tiled" data-i18n="posTiled">Tiled</option>
          </select>
        </div>
        <div class="control-group hidden" id="watermarkOpacityGroup">
          <label for="watermarkOpacity" data-i18n="watermarkOpacity">Opacity</label>
          <input type="range" id="watermarkOpacity" min="0.3" max="0.9" step="0.1" value="0.8">
        </div>
        <div class="control-group hidden" id="watermarkFontSizeGroup">
          <label for="watermarkFontSize" data-i18n="watermarkFontSize">Font size</label>
          <select id="watermarkFontSize">
            <option value="0.8" data-i18n="fontSizeSmall">Small</option>
            <option value="1" data-i18n="fontSizeMedium" selected>Medium</option>
            <option value="1.2" data-i18n="fontSizeLarge">Large</option>
          </select>
        </div>
        <div class="control-group hidden" id="watermarkTextGroup">
          <label for="watermarkText" data-i18n="watermarkTextLabel">Text</label>
          <input type="text" id="watermarkText" data-i18n-placeholder="watermarkPlaceholder" placeholder="Your name or text" maxlength="50">
        </div>
      </fieldset>
    </div>
  </aside>

  <div class="export-options-backdrop" id="exportOptionsBackdrop" aria-hidden="true"></div>
  <aside class="export-options-sheet" id="exportOptionsSheet" aria-hidden="true" role="dialog" aria-labelledby="exportOptionsTitle">
    <div class="export-options-sheet__header">
      <div class="export-options-sheet__handle"></div>
      <h2 id="exportOptionsTitle" data-i18n="exportOptionsTitle">Export options</h2>
      <button class="export-options-sheet__close" id="exportOptionsCloseBtn" data-i18n-aria-label="closeSettings" aria-label="Close">&times;</button>
    </div>
    <div class="export-options-sheet__body">
      <button type="button" class="btn btn-primary export-options-btn" id="exportOptionShare" data-i18n="exportShare">Share</button>
      <button type="button" class="btn btn-secondary export-options-btn" id="exportOptionDownload" data-i18n="exportDownload">Download</button>
      <button type="button" class="btn btn-secondary export-options-btn" id="exportOptionCopy" data-i18n="exportCopy">Copy to clipboard</button>
      <button type="button" class="btn btn-secondary export-options-btn" id="exportOptionOpenInNewTab" data-i18n="exportOpenInNewTab">Open in new tab</button>
    </div>
  </aside>

  <script type="module" src="js/app.js"></script>
</body>
</html>
